<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>TDD Agent</title>
<link rel="stylesheet" href="/static/styles.css">
</head>
<body>
<div class="container">
  <header>
    <div class="dot idle" id="indicator"></div>
    <h1>TDD Agent</h1>
  </header>

  <div class="form-card" id="form-card">
    <div class="field">
      <label>Ticket</label>
      <textarea id="ticket" placeholder="Describe the bug or feature..."></textarea>
    </div>
    <div class="field">
      <label>Target path</label>
      <div class="input-group">
        <input type="text" id="target" placeholder="Loading..." disabled>
        <button type="button" class="secondary" id="browse-btn" onclick="openDirBrowser()">Browse</button>
      </div>
      <div class="quick-select" id="quick-select"></div>
    </div>
    <div id="resume-section"></div>
    <div class="actions">
      <button id="run" onclick="startRun()">Run</button>
    </div>
  </div>

  <div class="stepper-row" id="stepper-row" style="display:none">
    <div class="stepper" id="stepper">
      <div class="step" data-step="PLAN">Plan</div>
      <div class="step" data-step="RED">Red</div>
      <div class="step" data-step="GREEN">Green</div>
      <div class="step" data-step="REVIEW">Review</div>
      <div class="step" data-step="REPORT">Report</div>
    </div>
    <button id="stop-btn" class="danger" onclick="stopPipeline()">Stop</button>
  </div>

  <div id="stages"></div>
</div>

<!-- Directory Browser Modal -->
<div class="modal-overlay" id="dir-modal">
  <div class="modal">
    <div class="modal-header">
      <span class="modal-title">Select Directory</span>
      <button class="modal-close" onclick="closeDirBrowser()">&times;</button>
    </div>
    <div class="dir-browser-header">
      Current: <span id="current-path">/</span>
    </div>
    <div class="search-bar">
      <input type="text" class="search-input" id="dir-search" placeholder="Search directories..." oninput="filterDirectories()">
    </div>
    <div class="modal-body">
      <ul class="dir-list" id="dir-list"></ul>
    </div>
  </div>
</div>

<script type="module" src="/static/js/main.js"></script>
</body>
</html>
